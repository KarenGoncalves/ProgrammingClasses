{
  "hash": "6701cde455a6c7308e6476b99cff20ab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Differential expression analysis plots\"\nauthor: \"Karen Cristine Goncalves, Ph.D.\"\ndescription: \"6th R class - transcriptomics sessions\"\nlinkcolor: grey\ncallout-appearance: simple\ncategories:\n  - R advanced\n  - \"Differential gene expression\"\n  - Omics\n  - Transcriptomics\nformat: \n  revealjs:\n    fontsize: 1.5em\n    transition: none\n    theme: dark\n    scrollable: true\n    output-location: fragment\ndate: \"April 4th 2024\"\nincremental: false\necho: true\nwarning: false\neval: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n## What is an enrichment analysis (pt1)\n\nEnrichment analysis is basically finding out if something is more frequent in a given group than it is supposed to be. Example, in 2023: \n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style='font-family: \"Trebuchet MS\", verdana, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Number of students enrolled in 2023 by university and degree</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> University </th>\n   <th style=\"text-align:right;\"> Undergrad </th>\n   <th style=\"text-align:right;\"> Graduate </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> UQTR </td>\n   <td style=\"text-align:right;\"> 11585 </td>\n   <td style=\"text-align:right;\"> 3659 </td>\n   <td style=\"text-align:right;\"> 15244 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> McGill </td>\n   <td style=\"text-align:right;\"> 30303 </td>\n   <td style=\"text-align:right;\"> 9077 </td>\n   <td style=\"text-align:right;\"> 39380 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> University of Toronto </td>\n   <td style=\"text-align:right;\"> 76061 </td>\n   <td style=\"text-align:right;\"> 21617 </td>\n   <td style=\"text-align:right;\"> 97678 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 117949 </td>\n   <td style=\"text-align:right;\"> 34353 </td>\n   <td style=\"text-align:right;\"> 152302 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## What is an enrichment analysis (pt2)\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style='font-family: \"Trebuchet MS\", verdana, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>In total, U of T has more undergrad and graduate students than either UQTR or McGill</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> University </th>\n   <th style=\"text-align:right;\"> Undergrad </th>\n   <th style=\"text-align:right;\"> Graduate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> UQTR </td>\n   <td style=\"text-align:right;\"> 9.822042 </td>\n   <td style=\"text-align:right;\"> 10.65118 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> McGill </td>\n   <td style=\"text-align:right;\"> 25.691613 </td>\n   <td style=\"text-align:right;\"> 26.42273 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> University of Toronto </td>\n   <td style=\"text-align:right;\"> 64.486346 </td>\n   <td style=\"text-align:right;\"> 62.92609 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 100.000000 </td>\n   <td style=\"text-align:right;\"> 100.00000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## What is an enrichment analysis (pt3)\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-minimal\" style='font-family: \"Trebuchet MS\", verdana, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>In proportion, UQTR had more graduate students in 2023 compared to either McGill or U of T</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> University </th>\n   <th style=\"text-align:right;\"> Undergrad </th>\n   <th style=\"text-align:right;\"> Graduate </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> UQTR </td>\n   <td style=\"text-align:right;\"> 75.99711 </td>\n   <td style=\"text-align:right;\"> 24.00289 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> McGill </td>\n   <td style=\"text-align:right;\"> 76.95023 </td>\n   <td style=\"text-align:right;\"> 23.04977 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> University of Toronto </td>\n   <td style=\"text-align:right;\"> 77.86912 </td>\n   <td style=\"text-align:right;\"> 22.13088 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Total </td>\n   <td style=\"text-align:right;\"> 77.44416 </td>\n   <td style=\"text-align:right;\"> 22.55584 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n. . .\n\nWe calculate the frequencies based on the total of what was counted (there are other universities in Canada, but since they were not included in the survey, we don't include them in the total). \n\nIn the case of the genes, you calculate the frequencies based only on the genes kept after filtering!\n\n\n## Prepare annotation information\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::source_gist(\"https://gist.github.com/KarenGoncalves/0db105bceff4ff69547ee25460dda978\")\n\ninstall_from_dif_sources(\n\tcran_packages = c(\"tidyverse\", \"patchwork\"),\n\tbioconductor_packages = c(\"AnnotationDbi\", \"biomaRt\", \"DBI\", \"clusterProfiler\", \"DOSE\")\n)\n\ntheme_classic() %>% theme_set\n```\n:::\n\n\n\n## Code from previous class: Prepare input {auto-animate=\"true\"}\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}